name: Job Conditionals

on:
  push:
    branches-ignore:
      - live
      - main

jobs:
  a:
    name: a
    if: false
    runs-on: ubuntu-latest

    steps:
      - run: echo "Hello world"
      
  b:
    name: b
    if: false
    runs-on: ubuntu-latest

    steps:
      - run: echo "Hello world"
      # - name: Try to fail
      #   run: exit 1
  c:
    name: c
    if: true
    runs-on: ubuntu-latest

    steps:
      - run: echo "Hello world"
      # - name: Try to fail
      #   run: exit 1

  always:
    name: always
    needs: [a, b, c]
    runs-on: ubuntu-latest
    if: ${{ always() && !failure() }}
    steps:
      - run: echo "Hello world"
      - run: echo ${{needs.a.result}}
      - run: echo ${{needs.b.result}}
      - run: echo ${{needs.c.result}}
      - name: Sleep for 10 seconds
        run: sleep 10s
        shell: bash

  after-always:
    name: after-always
    needs: [always]
    if: ${{ always() && !cancelled()  && !failure() }}
    runs-on: ubuntu-latest

    steps:
      - run: echo "Hello world"
      - run: echo ${{needs.always.result}}
      - run: echo "${{ toJSON(needs) }}"
      - name: Sleep for 10 seconds
        run: sleep 10s
        shell: bash

  independent:
    name: independent
    if: true
    runs-on: ubuntu-latest

    steps:
      - run: echo "Hello world"
      - name: Try to fail
        run: exit 1